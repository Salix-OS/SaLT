source ${cfgprefix}/include.cfg

# Try to load settings if we've been directly invoked
if [ -z "$locale" ]; then
  loadsettings
elif [ -z "$kb" ]; then
  loadsettings
fi

# Support booting as specified by loopback.cfg
if [ -n "${iso_path}" ]; then
  fromiso="fromiso=${iso_path}"
fi

set default=1
initmenu

loadlocales

# MENU
menuentry "${Lchangekb}" --hotkey k {
  configfile ${cfgprefix}/keyboard.cfg
}

menuentry "${Lstart}" --hotkey b {
  load_video
  echo "${Lliveloading}"
  linux /boot/vmlinuz root=/dev/ram0 quiet ${debug} lang=${locale} keyb=${kb} ${autologin} ${fromiso} ${ibus} ${memonly} ${numlock} ${passwd} ${proxy} ${runlevel} ${synaptics}
  initrd /boot/initrd.gz
}

menuentry "${Lcheatcode}" --hotkey o {
  configfile ${cfgprefix}/cheatcode.cfg
}

menuentry "${Lmemtest}" --hotkey m {
  linux16 /boot/mt86p
}

menuentry "${Lchangelang}" --hotkey l {
  configfile ${cfgprefix}/lang.cfg
}

menuentry "${Lsavesettings}" --hotkey s {
  unset skiplang
  getInput "${Lskiplang}" boolean "${Linvalrep}"
  if [ "$answer" = "true" ]; then
    skiplang=true
  fi
  unset answer
  save_env -f ${cfgprefix}/salt.env \
    autologin debug fromiso gfxpayload ibus kb kbnum lang langnum locale memonly numlock passwd proxy runlevel synaptics \
    skiplang
  if [ "$?" != "0" ]; then
    echo "${Lsaveenverr}"
  fi
}
# MENU END
