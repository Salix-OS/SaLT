# vim: syn=sh et sw=2 st=2 ts=2 tw=0:
source ${cfgprefix}/include.cfg
# Support booting as specified by loopback.cfg
if [ -n "$iso_path" ]; then
  set fromiso="fromiso=$iso_path"
fi

set default=0
set timeout=30
gettextvar title "Select an item:"

gettextvar Lmenutitle 'Start $distroname'
eval "set Lmenutitle=\"$Lmenutitle\""
if [ "$salt_debug" = "on" ]; then
  Lmenutitle="$Lmenutitle (debug)"
fi
menuentry "$Lmenutitle" --class=salix --class=gnu-linux {
  load_video
  gettextvar Lnotice '$distroname is loading...'
  eval "echo \"$Lnotice\""
  linux $basedir/boot/vmlinuz root=/dev/ram0 quiet max_loop=20 salt_debug=$salt_debug $salt_fromiso \
    salt_autologin=$salt_autologin salt_clock=$salt_clock salt_hwclock=$salt_hwclock salt_ibus=$salt_ibus salt_keyb=$salt_kb salt_lang=$salt_locale salt_memonly=$salt_memonly salt_numlock=$salt_numlock salt_passw=$salt_passwd salt_proxy=$salt_proxy salt_synaptics=$salt_synaptics salt_timezone=$salt_timezone \
    $salt_runlevel $salt_custom
  initrd $basedir/boot/initrd.gz
}

gettextvar Lmenutitle "Change boot options"
menuentry "$Lmenutitle" --class=preferences {
  newmenu ${cfgprefix}/cheatcode.cfg
}

gettextvar Lmenutitle "Check correct time"
set Lmenutitle="$Lmenutitle [$salt_clock]"
menuentry "$Lmenutitle" --class=clock {
  newmenu ${cfgprefix}/clock.cfg
}

gettextvar Lmenutitle "Change language"
set Lmenutitle="$Lmenutitle [$salt_locale]"
menuentry "$Lmenutitle" --class=locale {
  newmenu ${cfgprefix}/lang.cfg
}

gettextvar Lmenutitle "Change keyboard layout"
set Lmenutitle="$Lmenutitle [$salt_kb]"
menuentry "$Lmenutitle" --class=keyboard {
  newmenu $cfgprefix/keyboard.cfg
}

gettextvar Lmenutitle "Save all settings to be autoloaded for future boots"
menuentry "$Lmenutitle" --class=save {
  savesettings
}

gettextvar Lmenutitle "Quit grub and run the hardware detection tool"
menuentry "$Lmenutitle" --class=monitor {
  linux16 $basedir/boot/memdisk
  initrd16 $basedir/boot/hdt.img
}

gettextvar Lmenutitle "Quit grub and run a memory test"
menuentry "$Lmenutitle" --class=monitor {
  linux16 $basedir/boot/mt86p
}

gettextvar Lmenutitle "Reboot"
menuentry "$Lmenutitle" --class=reboot {
  reboot
}
